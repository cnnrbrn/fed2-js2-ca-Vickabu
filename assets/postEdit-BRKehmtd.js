import{a as u}from"./read-CZ4ZNcVz.js";import{A as p,h as m}from"./headers-CvDvskcI.js";async function g(t,{title:e,body:s,tags:n,media:a}){try{const o=await fetch(`${p}/${t}`,{method:"PUT",headers:m(),body:JSON.stringify({title:e,body:s,tags:n,media:a?{url:a.url,alt:a.alt}:null})});if(!o.ok){const i=await o.json();throw new Error(`Error ${o.status}: ${i.message}`)}const{data:d}=await o.json();return d}catch(o){throw console.error("Error updating post:",o),o}}async function y(t,e){t.preventDefault();const s=t.target.title.value,n=t.target.body.value,a=t.target.tags.value.split(",").map(l=>l.trim()),o=t.target.mediaUrl.value,d=t.target.mediaAlt.value,i=o?{url:o,alt:d}:null;try{const l=await g(e,{title:s,body:n,tags:a,media:i});window.location.href="/"}catch(l){console.error("Error while updating post:",l)}}const c=JSON.parse(localStorage.getItem("postId")),r=document.forms.editPost;async function f(){try{const t=await u(c);if(t&&t.data){const{title:e,body:s,tags:n=[],media:a}=t.data;r.title.value=e,r.body.value=s,r.tags.value=n.join(", "),r.mediaUrl.value=a?.url||"",r.mediaAlt.value=a?.alt||""}else console.error("Post not found."),document.body.innerHTML="<p>Post not found.</p>"}catch(t){console.error("Error loading post:",t),document.body.innerHTML="<p>Failed to load post. Please try again later.</p>"}}r.addEventListener("submit",t=>y(t,c));f();
